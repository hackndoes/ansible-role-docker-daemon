---
- name: Install AUFS storage driver support packages
  apt: name={{ item }} state=present
  with_items: 
    - "linux-image-extra-{{ ansible_kernel }}"
    - "linux-image-extra-virtual"
  tags:
    - "install"
    - "docker"

- name: "Install docker + reqs"
  apt: name="{{ item }}" update_cache=yes state=latest
  with_items:
    - docker-engine
    - python-pip
  tags:
    - apt

- name: "Install docker-py"
  pip:
    name: docker-py
    state: present
    version: "{{ docker_py_version }}"
  tags:
    - pip

- name: Install docker-engine
  apt: name="docker-engine={{ docker_engine_version }}-0~{{ ansible_distribution_release }}" state=installed
  tags:
    - "install"
    - "docker"

- name: "add {{ ansible_user }} to docker group"
  become: yes
  user:
    name="{{ ansible_user }}"
    groups=docker
    append=yes
  tags:
    - service

